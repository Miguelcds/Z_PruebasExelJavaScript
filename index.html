<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asignador de Zonas de Bilbao</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            color: aliceblue;
            background-color: black;
            background-image: url("bilbo.jpg");
            /*background-size: cover;*/
            background-repeat: no-repeat;
            /*position: relative;*/
        }

        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Oscurece la imagen con un color negro semitransparente */
            z-index: -1; /* contenido por detras */
        }

        h1{
            padding-top: 100px;
            text-align: center;
        }
        .upload-container {
            margin-top: 150px;
            border: 5px dashed #ff0000;
            padding: 40px;
            padding-bottom: 60px;
            text-align: center;
            margin-bottom: 20px;
        }
        button {
            background-color: #4CAF50;
            color: rgb(0, 0, 0);
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;

        }
        button:disabled {
            background-color: #ff0000;
        }
        #results {
            margin-top: 0px;
        }

        @media (max-width: 500px ) {

            h1{
                margin-top: 20px;
                padding-top: 10px;
            }

            .upload-container{
                display: flex;
                flex-direction: column;
                margin-top: 50px;
                border: none;

            }
    
        }

    </style>
</head>
<body>
    <h1>Asignador de Zonas de Bilbao</h1>
    
    <div class="upload-container">
        <p>Selecciona tu archivo Excel (.xlsx) con las calles:</p>
        <input type="file" id="fileInput" accept=".xlsx, .xls" />
        <button id="processBtn" disabled>Procesar Archivo</button>
        <button id="downloadBtn" disabled>Descargar Resultado</button>
    </div>
    
    <div id="results"></div>

    <!-- SheetJS (xlsx) libreria para usar Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    
    <script>
    
        const zonasEstandar = {

                //  DEUSTO: 

                "ANDALUCÍA": "Deusto",
                "ARAGÓN": "Deusto",
                "ASTURIAS": "Deusto",
                "AV LEHENDAKARI AGUIR": "Deusto o San Ignacio *Verficacion pdnt*",
                "AV MADARIAGA": "Deusto",
                "AV RAMÓN Y CAJAL": "Deusto",
                "BADAJOZ": "Deusto",
                "BENITA ASAS": "Deusto",
                "BLAS DE OTERO": "Deusto",
                "BURGOS": "Deusto",
                "CACERES": "Deusto",
                "CANTABRIA": "Deusto",
                "EGUZKILORE": "Deusto",
                "ENEKURI": "Deusto",
                "EXTREMADURA": "Deusto",
                "FRANCESC MACIA": "Deusto",
                "GALICIA": "Deusto",
                "GREGORIO BALPARDA": "Deusto",
                "HELIODORO DE LA TORRE": "Deusto",
                "IBAREKOLANDA": "Deusto",
                "ITURRIKOETXE": "Deusto",
                "JON ARROSPIDE": "Deusto",
                "JUAN DE URBIETA": "Deusto",
                "JULIO LAZURTEGUI": "Deusto",
                "JULIO URQUIJO": "Deusto",
                "LA RIOJA": "Deusto",
                "LAGUNETXEA": "Deusto",
                "LOGROÑO": "Deusto",
                "LUIS POWER": "Deusto",
                "LUZARRA": "Deusto",
                "MATXINTXU": "Deusto",
                "CA MORGAN": "Deusto",
                "NAVARRA": "Deusto",
                "PL PLACIDO CAREAGA": "Deusto",
                "RAFAELA YBARRA": "Deusto",
                "RIBERA DE BOTICA VIEJA": "Deusto",
                "SAGRADA FAMILIA": "Deusto",
                "PL SAN PEDRO": "Deusto",
                "PL SAN PIO X": "Deusto",
                "IRUÑA":"Deusto",
                "AV RAMON Y CAJAL":"Deusto",
                "GENERAL ERASO":"Deusto",
                "HELIODORO DE LA TORR":"Deusto",
                "MUSICO SARASATE":"Deusto",
                "PU DEUSTU":"Deusto",
                "RI BOTICA VIEJA":"Deusto",
                "SANCHO DE AZPEITIA":"Deusto",
                "TR RAMON Y CAJAL":"Deusto",
                //"":"Deusto",
                //"":"Deusto",
                //"":"Deusto",
            
            
                // RI DEUSTO:

                "RI DEUSTU": "Deusto Muelle",
                "RAMAL OLABEAGA": "Deusto Muelle",
                "RI ZORROTZAURRE": "Deusto Muelle",
                //"": "Deusto Muelle",
                
                // DEUSTO MONTE:

                "GORBEIA": "Deusto Monte",
                "MONTE GANEKOGORTA": "Deusto Monte",
                "CA MIRAMAR": "Deusto Monte",
                "EGILEOR": "Deusto Monte",
                "GR VIRGEN DEL PINAR": "Deusto Monte",
                "MONTE GANETA": "Deusto Monte",
                "MONTE JATA": "Deusto Monte",
                "ARANEKO": "Deusto Monte",
                //"": "Deusto Monte",
                //"": "Deusto Monte",



                //  SAN IGNACIO:

                "ANDALUCIA": "San Ignacio",
                "ARTURO CAMPION": "San Ignacio",
                "AV TXOMIN GARAT": "San Ignacio",
                "AV ZUMALAKARREGI": "San Ignacio",
                "BENIDORM": "San Ignacio",
                "ELORRIETA": "San Ignacio",
                "ETXENAGUSIA": "San Ignacio",
                "ERDIKOETXE":"San Ignacio",
                "ISLAS CANARIAS": "San Ignacio",
                "NAVARRO VILLOSLADA": "San Ignacio",
                "ORIXE": "San Ignacio",
                "PL LEVANTE": "San Ignacio",
                "PL AITA PATXI": "San Ignacio",
                "PL CELESTINO MARIA D": "San Ignacio",
                "PINTOR ETXENAGUSIA": "San Ignacio",
                "SAN IGNACIO AUZOA": "San Ignacio",
                "CATALUNYA":"San Ignacio",
                "LARRAKOTORRE":"San Ignacio",
                "RI ELORRIETA":"San Ignacio",
                "MIKEL ZARATE":"San Ignacio",
                "PEDRO ASTIGARRAGA":"San Ignacio",
                "ARAGON":"San Ignacion",
                "AV ZARANDOA":"San Ignacion",
                "CA ETXEZURI BIDEA":"San Ignacion",
                "ERRONDOKO":"San Ignacion",
                "ESCULTOR FRANCISCO D":"San Ignacion",
                "IBARREKOLANDA KALEA":"San Ignacion",
                "JUAN DE ANTXETA":"San Ignacion",
                "MAR MEDITERRANEO":"San Ignacion",
                "PINTOR ANTONIO GUEZA":"San Ignacion",
                "PINTORES ARRUE":"San Ignacion",
                "PL LANDABASO":"San Ignacion",
                "PL SARRIKOALDE":"San Ignacion",
                "RICARDO GUTIERREZ AB":"San Ignacion",
                "UNIVERSIDAD DE OÑATI":"San Ignacion",
                //"":"San Ignacio",
                //"":"San Ignacio",
                 
                      
                //  MATIKO 

                "URIBARRI":"Matiko",
                "TRAUKO":"Matiko",
                "URIBARRI":"Matiko",
                "SAN ROKE":"Matiko",
                "RICARDO ARREGUI":"Matiko",
                "HUERTAS DE LA VILLA":"Matiko",
                "CASTAÑOS":"Matiko",
                "ANSELMA DE SALCES":"Matiko",
                "ARTATSAMINA":"Matiko",
                "AV MAURICE RAVEL":"Matiko",
                "AV UNIVERSIDADES":"Matiko",
                "BA ASUNCION":"Matiko",
                "CRISTO":"Matiko",
                "GR MONTAÑO":"Matiko",
                "LA SALVE":"Matiko",
                "MAESTRO DAMIAN GONZA":"Matiko",
                "MATIKO":"Matiko",
                "MONTE ARNO":"Matiko",
                "MONTE IZARO":"Matiko",
                "MUGICA Y BUTRON":"Matiko",
                "MUROS DE SAN PEDRO":"Matiko",
                "PA CAMPO VOLANTIN":"Matiko",
                "PL ERNESTO ERKOREKA":"Matiko",
                "PL FUNICULAR":"Matiko",
                "PL JESUS INSAUSTI":"Matiko",
                "PL LA SALVE":"Matiko",
                "PL MORAZA":"Matiko",
                "PRINCIPE DE VIANA":"Matiko",
                "RICARDO ARREGUI":"Matiko",
                "TIBOLI":"Matiko",
                "TR TIBOLI":"Matiko",
                "TRISTAN DE LEGUIZAMO":"Matiko",
                "TUTULU":"Matiko",
                //"":"Matiko",
                //"":"Matiko",

                // MATIKO ALTO

                "CA LANDETA BIDEA":"Matiko Alto",
                "ABASOLO":"Matiko Alto",
                "BAKIO":"Matiko Alto",
                "ETXEZURI":"Matiko Alto",
                "GORLIZ":"Matiko Alto",
                "GR MIRADOR A BILBAO":"Matiko Alto",
                "PLENTZIA":"Matiko Alto",
                "SAN VALENTIN DE BERR":"Matiko Alto",
                "SANTURTZI":"Matiko Alto",
                "TR CIUDAD JARDIN":"Matiko Alto",
                "ZUMAIA":"Matiko Alto",
                "ZURBARAN":"Matiko Alto",
                //"":"Matiko Alto",
                //"":"Matiko Alto",

                //  BILBAO CENTRO

                "AL GREGORIO DE LA RE":"Bilbao Centro",
                "AL URQUIJO": "Bilbao Centro",
                "ARANE": "Bilbao Centro",
                "AUTONOMIA": "Bilbao Centro",
                "AV LAPURDI": "Bilbao Centro",
                "AV SABINO ARANA ": "Bilbao Centro",
                "BERASTEGUI": "Bilbao Centro",
                "BERTENDONA": "Bilbao Centro",
                "ESTACION DE BASURTU": "Bilbao Centro",
                "GENERAL CONCHA": "Bilbao Centro",
                "GURTUBAY": "Bilbao Centro",
                "HEROS": "Bilbao Centro",
                "HURTADO DE AMEZAGA": "Bilbao Centro",
                "IBAÑEZ DE BILBAO": "Bilbao Centro",
                "IPARRAGUIRRE": "Bilbao Centro",
                "IRALA": "Bilbao Centro",
                "JUAN AJURIAGUERRA": "Bilbao Centro",
                "LICENCIADO POZA": "Bilbao Centro",
                "LUIS BRIÑAS": "Bilbao Centro",
                "LUTXANA": "Bilbao Centro",
                "MEDINA DE POMAR": "Bilbao Centro",
                "OLITE": "Bilbao Centro",
                "PL GENERAL LATORRE": "Bilbao Centro",
                "RODRIGUEZ ARIAS":"Bilbao Centro",
                "URIZAR":"Bilbao Centro",
                "ZANKOETA":"Bilbao Centro",
                "HURTADO DE AMEZAGA":"Bilbao Centro",
                "CARDENAL GARDOQUI":"Bilbao Centro",
                "EUSKALDUNA":"Bilbao Centro",
                "ENRIQUE EGUREN":"Bilbao Centro",
                "SIMON BOLIVAR":"Bilbao Centro",
                "LEDESMA":"Bilbao Centro",
                "COSME ECHEVARRIETA":"Bilbao Centro",
                "AVILA": "Bilbao Centro",
                "GENERAL EGUIA": "Bilbao Centro",
                "MARIA DIAZ DE HARO": "Bilbao Centro",
                "LABAYRU": "Bilbao Centro",
                "AL URQUIJO": "Bilbao Centro",
                "PEREZ GALDOS": "Bilbao Centro",
                "ACEBAL IDIGORAS": "Bilbao Centro",
                "AL DOCTOR AREILZA": "Bilbao Centro",
                "AL GREGORIO DE LA RE": "Bilbao Centro",
                "AL MAZARREDO": "Bilbao Centro",
                "AL RECALDE": "Bilbao Centro",
                "AL SAN MAMES": "Bilbao Centro",
                "ALCALDE FELIPE UHAGO": "Bilbao Centro",
                "AMISTAD": "Bilbao Centro",
                "ANDRES ISASI": "Bilbao Centro",
                "ANTONIO DE TRUEBA": "Bilbao Centro",
                "ASTARLOA": "Bilbao Centro",
                "AURELIANO VALLE": "Bilbao Centro",
                "AV BERGARA": "Bilbao Centro",
                "AV FERROCARRIL": "Bilbao Centro",
                "AV JUAN ANTONIO ZUNZ": "Bilbao Centro",
                "AV KIRIKIÑO": "Bilbao Centro",
                "AV PINTOR LECUONA": "Bilbao Centro",
                "AV ZUBEROA": "Bilbao Centro",
                "BAIONA": "Bilbao Centro",
                "BARRAINCUA": "Bilbao Centro",
                "BATALLA DE PADURA": "Bilbao Centro",
                "BUENOS AIRES": "Bilbao Centro",
                "CALIXTO DIEZ ": "Bilbao Centro",
                "COLON DE LARREATEGUI": "Bilbao Centro",
                "COSTA": "Bilbao Centro",
                "DIPUTACION": "Bilbao Centro",
                "DOCTOR FELIX LANDIN": "Bilbao Centro",
                "DOLORES IBARRURI": "Bilbao Centro",
                "EGAÑA": "Bilbao Centro",
                "ELCANO": "Bilbao Centro",
                "ES MALA": "Bilbao Centro",
                "ESKURTZE": "Bilbao Centro",
                "ESTRAUNTZA": "Bilbao Centro",
                "FERNANDEZ DEL CAMPO": "Bilbao Centro",
                "GENERAL SALAZAR": "Bilbao Centro",
                "GR DON DIEGO LOPEZ D": "Bilbao Centro",
                "HENAO": "Bilbao Centro",
                "ITURRIBARRIA": "Bilbao Centro",
                "ITURRIZA": "Bilbao Centro",
                "JOSE MARIA ESCUZA": "Bilbao Centro",
                "JOSE MARIA OLAVARRI": "Bilbao Centro",
                "JOSE OLABARRIA": "Bilbao Centro",
                "JUAN DE GARAY": "Bilbao Centro",
                "LEHENDAKARI LEIZAOLA": "Bilbao Centro",
                "LERSUNDI": "Bilbao Centro",
                "LUIS BRAILLE": "Bilbao Centro",
                "MACHIN": "Bilbao Centro",
                "MAESTRO GARCIA RIVER": "Bilbao Centro",
                "MANUEL ALLENDE": "Bilbao Centro",
                "MARCELINO OREJA": "Bilbao Centro",
                "MARQUES DEL PUERTO": "Bilbao Centro",
                "MAXIMO AGUIRRE": "Bilbao Centro",
                "ME ABANDO S.N": "Bilbao Centro",
                "NERBIOI": "Bilbao Centro",
                "NOVIA SALCEDO": "Bilbao Centro",
                "PA URIBITARTE": "Bilbao Centro",
                "PABLO DE ALZOLA": "Bilbao Centro",
                "PABLO PICASSO": "Bilbao Centro",
                "PADRE LOJENDIO": "Bilbao Centro",
                "PEDRO MARTINEZ ARTOL": "Bilbao Centro",
                "PL ALTO DE SOMOSIERR": "Bilbao Centro",
                "PL CASILLA": "Bilbao Centro",
                "PL CIRCULAR": "Bilbao Centro",
                "PL EMILIO CAMPUZANO": "Bilbao Centro",
                "PL EUSKADI": "Bilbao Centro",
                "PL FEDERICO MOYUA": "Bilbao Centro",
                "PL GARELLANO": "Bilbao Centro",
                "RAMON RUBIAL KALEA": "Bilbao Centro",
                "RIPA": "Bilbao Centro",
                "SANTIAGO BROUARD": "Bilbao Centro",
                "TR URIBITARTE": "Bilbao Centro",
                "UGALDE": "Bilbao Centro",
                "URKIOLA": "Bilbao Centro",
                "VILLARIAS": "Bilbao Centro",
                "ERCILLA":"Bilbao Centro",
                "ALMIRANTE ANTONIO GA": "Bilbao Centro",
                "PL MOZART": "Bilbao Centro",
                //"": "Bilbao Centro",

                // BILBAO-BASURTU

                "ES MASUSTEGI":"Bilbao-Basurtu",
                "CA BASURTU-KASTREXAN":"Bilbao-Basurtu",
                "BA ALTAMIRA":"Bilbao-Basurtu",
                "LEZEAGA":"Bilbao-Basurtu",
                "AUNTZETXETA":"Bilbao-Basurtu",
                "BENTAZARRA":"Bilbao-Basurtu",
                "ES ENTRAMBASAGUAS ":"Bilbao-Basurtu",
                "PL BASURTUGORTA":"Bilbao-Basurtu",
                //"":"Bilbao-Basurtu",
                //"":"Bilbao-Basurtu",
                //"":"Bilbao-Basurtu",
                //"":"Bilbao-Basurtu",

                // BILBAO-MUELLE

                "CA TROKA BIDEA":"Bilbao Muelle",
                "CA VENTOSA":"Bilbao Muelle",
                "SAN NICOLAS DE OLABE":"Bilbao Muelle",
                "URGOZO":"Bilbao Muelle",
                //"":"Bilbao Muelle",
                
                // KASKO VIEJO

                "ANDRA MARI": "Kasko Viejo",
                "ARTEKALE": "Kasko Viejo",
                "PL UNAMUNO": "Kasko Viejo",
                "BARRENKALE": "Kasko Viejo",
                "BARRANKALE BARRENA": "Kasko Viejo",
                "BELOSTIKALE": "Kasko Viejo",
                "CARNICERIA VIEJA": "Kasko Viejo",
                "CORREO": "Kasko Viejo",
                "CORREOS": "Kasko Viejo",
                "LA RIBERA": "Kasko Viejo",
                "MERCED": "Kasko Viejo",
                "PL ARRIAGA": "Kasko Viejo",
                "PL MIGUEL DE UNAMUNO": "Kasko Viejo",
                "PL NUEVA": "Kasko Viejo",
                "PL SANTIAGO": "Kasko Viejo",
                "PL SANTOS JUANES": "Kasko Viejo",
                "RIBERA": "Kasko Viejo",
                "RIBERA VIEJA": "Kasko Viejo",
                "SOMERA": "Kasko Viejo",
                "TENDERIA": "Kasko Viejo",
                "RONDA":"Kasko Viejo",
                "JARDINES":"Kasko Viejo",
                "ASKAO":"Kasko Viejo",
                "ARENAL":"Kasko Viejo",
                "BIDEBARRIETA":"Kasko Viejo",
                "CRUZ":"Kasko Viejo",
                "ENCARNACION":"Kasko Viejo",
                "ESPERANZA":"Kasko Viejo",
                "NUEVA":"Kasko Viejo",
                "SANTA MARIA":"Kasko Viejo",
                "VIUDA DE EPALZA":"Kasko Viejo",
                "ARENAL":"Kasko Viejo",
                "BIDEBARRIETA":"Kasko Viejo",
                "CRUZ":"Kasko Viejo",
                "ENCARNACION":"Kasko Viejo",
                "ESPERANZA":"Kasko Viejo",
                "NUEVA":"Kasko Viejo",
                "SANTA MARIA":"Kasko Viejo",
                "VIUDA DE EPALZA":"Kasko Viejo",
                //"":"Kasko Viejo",
             
            
                // SANTUTXU

                "ITURRIBIDE": "Santutxu",
                "OLLERIAS ALTAS": "Santutxu",
                "LUIS LUCIANO BONAPAR": "Santutxu",
                "SANTA CECILIA": "Santutxu",
                "GR SAGARMINAGA": "Santutxu",
                "SAGARMINAGA": "Santutxu",
                "MEDICO ANTONIO EGUIL": "Santutxu",
                "SANTUTXU": "Santutxu",
                "MASUSTEGI": "Santutxu",
                "PL ARQUITECTO RICARD":"Santutxu",
                "JUAN GUISASOLA": "Santutxu",
                "AV INDALECIO PRIETO": "Santutxu",
                "SANTA CLARA": "Santutxu",
                "PL LUIS ECHEVARRIA": "Santutxu",
                "BA AZURLEKU": "Santutxu",
                "ARSUAGA":"Santutxu",
                "ATEGORRI TXAKOLINDEG":"Santutxu",
                "AURREKOETXEA":"Santutxu",
                "AV MIRAFLORES":"Santutxu",
                "AV ZUMALACARREGUI":"Santutxu",
                "BA GARDEAZABAL":"Santutxu",
                "CA BILBAO-GALDAKAO":"Santutxu",
                "CA DEL BOSQUE":"Santutxu",
                "CASERIO LANDABURU":"Santutxu",
                "COCHERITO DE BILBAO":"Santutxu",
                "ELIZONDO":"Santutxu",
                "ENRIQUE IBARRETA":"Santutxu",
                "FIKA":"Santutxu",
                "GEORGE STEER":"Santutxu",
                "GEORGIA":"Santutxu",
                "GR MONSEÑOR REMIGIO":"Santutxu",
                "GR RVDO.VICENTE GARA":"Santutxu",
                "ITURRIAGA":"Santutxu",
                "JOSE MARIA LIDON":"Santutxu",
                "JOSE MIGUEL DE BARAN":"Santutxu",
                "JUAN DE IRIGOYEN":"Santutxu",
                "JUAN DE LA COSA":"Santutxu",
                "JUAN GARDEAZABAL":"Santutxu",
                "JUAN VIAR":"Santutxu",
                "JULIAN BOLIVAR ELORD":"Santutxu",
                "KA ORTUTXUETA":"Santutxu",
                "KALAMUA":"Santutxu",
                "KARMELO":"Santutxu",
                "LANDAORLEGUI":"Santutxu",
                "MARCELINO MENENDEZ Y":"Santutxu",
                "MONTE MANDOIA":"Santutxu",
                "MUSICO ARAMBARRI":"Santutxu",
                "OGOÑO":"Santutxu",
                "OLLERIAS BAJAS":"Santutxu",
                "PABLO ZAMARRIPA":"Santutxu",
                "PADRE ESTEBAN PERNET":"Santutxu",
                "PARTICULAR ALLENDE":"Santutxu",
                "PINTOR ANGEL LARROQU":"Santutxu",
                "PINTOR ANSELMO GUINE":"Santutxu",
                "PINTOR AURELIO ARTET":"Santutxu",
                "PINTOR LOSADA":"Santutxu",
                "PINTORES ZUBIAURRE":"Santutxu",
                "PL HARO":"Santutxu",
                "PL LAUAXETA":"Santutxu",
                "PL RVDO. SANTIAGO LA":"Santutxu",
                "PL SAN MARTIN DE LA":"Santutxu",
                "PL SAN MARTIN DE LA ASCENCION":"Santutxu",
                "PL ZUMARRAGA":"Santutxu",
                "PRIM":"Santutxu",
                "RESURRECCION MARIA D":"Santutxu",
                "SAN FRANCISQUITO":"Santutxu",
                "SAN JOAQUIN":"Santutxu",
                "SANTA LUCIA":"Santutxu",
                "SANTO ROSARIO":"Santutxu",
                "SOLOKOETXE":"Santutxu",
                "SORKUNDE":"Santutxu",
                "TORRE GOROSTITZAGA":"Santutxu",
                "TR CONCEPCION":"Santutxu",
                "TR ITURRIAGA":"Santutxu",
                "ZABALBIDE":"Santutxu",
                "ZUMARRAGA":"Santutxu",
                "TELLERIA":"Santutxu Cerca de casa",
                //"": "Santutxu",
                //"": "Santutxu",


                // SANTUTXU ALTO:

                "SAN ISIDRO":"Santutxu Alto",
                "PL ENCARNACION":"Santutxu Alto",
                "BA CRUZ":"Santutxu Alto",
                "BILINTX":"Santutxu Alto",
                "GR BEGOÑALDE":"Santutxu Alto",
                "GR MEDICO MUNICIPAL":"Santutxu Alto",
                "GR SANTO DOMINGO DE":"Santutxu Alto",
                "MAESTRO MENDIRI":"Santutxu Alto",
                "MARIA AGUIRRE AGUIRR":"Santutxu Alto",
                "PL JUAN XXIII":"Santutxu Alto",
                "VIRGEN DE BEGOÑA":"Santutxu Alto",
                //"":"Santutxu Alto",

                // SANFRA

                "SAN FRANCISCO": "SanFra",
                "HERNANI": "SanFra",
                "BILBAO LA VIEJA": "SanFra",
                "BRUNO MAURICIO ZABAL": "SanFra",
                "BAILEN": "SanFra",
                "ARECHAGA": "SanFra",
                "CANTARRANAS":"San Francisco",
                "CONCEPCION":"San Francisco",
                "CORTES":"San Francisco",
                "GIMNASIO":"San Francisco",
                "LA LAGUNA":"San Francisco",
                "LAMANA":"San Francisco",
                "LUIS IRUARRIZAGA":"San Francisco",
                "MENA":"San Francisco",
                "OLANO":"San Francisco",
                "PL SARALEGI":"San Francisco",
                "TR ZABALA":"San Francisco",
                "XENPELAR":"San Francisco",
                //"": "SanFra",
                //"": "SanFra",

                //MIRIBILLA

                "GOIKO TORRE": "Miribilla",
                "AV SAN ADRIAN": "Miribilla",
                "JA GERNIKA LORATEGIA": "Miribilla",
                "ANGEL ORTIZ ALFAU": "Miribilla",
                "DOCTOR ESPINOSA ORIB": "Miribilla",
                "AGARRE":"Miribilla",
                "ANDRES ELISEO MAÑARI":"Miribilla",
                "AV ASKATASUNA":"Miribilla",
                "DON CLAUDIO GALLASTE":"Miribilla",
                "JA DE GERNIKA":"Miribilla",
                "JUAN CARLOS DE GORTA":"Miribilla",
                "JULIAN ZUGAZAGOITIA":"Miribilla",
                "MARTIN BARUA PICAZA":"Miribilla",
                "MIMBRES":"Miribilla",
                "MINA SAN LUIS":"Miribilla",
                "MIRIBILLA":"Miribilla",
                "MONTE ERETZA":"Miribilla",
                "SANTIAGO AZNAR":"Miribilla",
                "SANTIAGO DE COMPOSTE":"Miribilla",
                "TENOR CONSTANTINO":"Miribilla",
                //"": "Miribilla",
                //"": "Miribilla",

                // ZAMAKOLA

                "URAZURRUTIA":"Zamakola",
                "ZAMAKOLA":"Zamakola",
                "ARGINAO":"Zamakola",
                "CA IRUSTA BIDEA":"Zamakola",
                "CAMPA IBAIZABAL":"Zamakola",
                "IBAIALDE":"Zamakola",
                //"":"Zamakola",
                //"":"Zamakola",

                // ZORROZA

                "CORDELERIA": "Zorroza",
                "CA ZORROTZA-KASTREXA": "Zorroza",
                "GR JARDIN DE ZORROTZ": "Zorroza",
                "GR IKASTALDE": "Zorroza",
                "AV MONTEVIDEO-ZORROZ": "Zorroza",
                "ASTILLERO":"Zorroza",
                "CA ZAZPILANDA":"Zorroza",
                "CA ZORROZGOITI":"Zorroza",
                "ES ABARO":"Zorroza",
                "ES ZALBIDEA":"Zorroza",
                "ESTACION DE ZORROTZA":"Zorroza",
                "FRAY JUAN":"Zorroza",
                "GR ALDAPETA":"Zorroza",
                "GR BIDEGAIN":"Zorroza",
                "GR MENDIGAIN":"Zorroza",
                "GR PINADIA":"Zorroza",
                "MUSICO USANDIZAGA":"Zorroza",
                "PARROCO VICENTE ZABA":"Zorroza",
                "ZORROTZABASO":"Zorroza",
                "ZORROTZAGANA":"Zorroza",
                //"": "Zorroza",
                //"": "Zorroza",

                // ZURBARANBARRI

                "CA VIA VIEJA DE LEZA":"Zurbaranbarri",
                "BA ZURBARANBARRI":"Zurbaranbarri",
                "BA ANDRAMARIA DE BEG":"Zurbaranbarri",
                "BA SARRIKUE":"Zurbaranbarri",
                "PL ITURRIONDO":"Zurbaranbarri",
                //"":"Zurbaranbarri",
                //"":"Zurbaranbarri",

                // REKALDE

                "ESPERANTO": "Rekalde",
                "MATILDE ORBEGOZO": "Rekalde",
                "FILOMENA BALDEZATE": "Rekalde",
                "CA ERREKALDE-LARRASK": "Rekalde",
                "ERREKALDEBERRI": "Rekalde",
                "HIJAS DE LA CARIDAD": "Rekalde",
                "PL ERREKALDE": "Rekalde",
                "SOLLUBE": "Rekalde",
                "MONCADA": "Rekalde",
                "ALTUBE":"Rekalde",
                "ANBOTO":"Rekalde",
                "BA BETOLATZA":"Rekalde",
                "BA URETAMENDI":"Rekalde",
                "BENITO ALBERDI":"Rekalde",
                "BIARRITZ":"Rekalde",
                "CA ARTAZU BIDEA":"Rekalde",
                "CA CIRCUNVALACION":"Rekalde",
                "CA ITURRIGORRI BIDEA":"Rekalde",
                "CA PEÑASCAL":"Rekalde",
                "CAMILO VILLABASO":"Rekalde",
                "CIUDADELA":"Rekalde",
                "DOCTOR ENTRECANALES":"Rekalde",
                "ELEXABARRI":"Rekalde",
                "ES CALEROS":"Rekalde",
                "GAZTELUONDO":"Rekalde",
                "GAZTELUONDO-ALHONDIG":"Rekalde",
                "GORDONIZ":"Rekalde",
                "JAEN":"Rekalde",
                "LA PAZ":"Rekalde",
                "LEON DE URUÑUELA":"Rekalde",
                "MARIA VICTORIA URIBE":"Rekalde",
                "MENDIPE":"Rekalde",
                "PADRE LARRAMENDI":"Rekalde",
                "PEÑA LEMONA":"Rekalde",
                "PL ALFREDO KRAUS":"Rekalde",
                "PL BELATEGUI":"Rekalde",
                "SALOU":"Rekalde",
                "SERANTES":"Rekalde",
                "TOLOSA":"Rekalde",
                "TR ALTUBE":"Rekalde",
                //"": "Rekalde",
                //"": "Rekalde",

                // TXURDINAGA:

                "UGARTE":"Txurdinga",
                "ZIZERUENA":"Txurdinga",
                "GARATE":"Txurdinga",
                "AV GABRIEL ARESTI":"Txurdinga",
                "AV JESUS GALINDEZ":"Txurdinga",
                "AV PAU CASALS":"Txurdinga",
                "LARRAKOETXE":"Txurdinga",
                "TXOTENA":"Txurdinga",
                "LANGARAN":"Txurdinga",
                "ARBIDEA":"Txurdinaga",
                "ARTAZURIÑA":"Txurdinaga",
                "AV JULIAN GAIARRE":"Txurdinaga",
                "DOCTOR ORNILLA":"Txurdinaga",
                "FERNANDO JIMENEZ MIE":"Txurdinaga",
                "GARAIZAR":"Txurdinaga",
                "GR AIXEONA":"Txurdinaga",
                "GR MAKALDI":"Txurdinaga",
                "LA FRATERNIDAD":"Txurdinaga",
                "ONDARROA":"Txurdinaga",
                "TR ARBOLANTXA":"Txurdinaga",
                "ZUHATZU":"Txurdinaga",
                //"":"Txurdinga",
                //"":"Txurdinga",
        };

        // Variables globales
        let processedData = [];
        const processBtn = document.getElementById('processBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const fileInput = document.getElementById('fileInput');
        const resultsDiv = document.getElementById('results');

        // Habilitar botón cuando se selecciona un archivo
        fileInput.addEventListener('change', (e) => {
            processBtn.disabled = !e.target.files.length;
        });

        // Función para asignar zona
        function asignarZona(calle) {
            if (!calle) return "";
            
            const calleUpper = calle.toString().toUpperCase().trim();
            
            // 1. Búsqueda exacta
            for (const [clave, zona] of Object.entries(zonasEstandar)) {
                if (calleUpper.includes(clave)) {
                    return zona;
                }
            }
            
            return "";
        }

        // Procesar el archivo Excel
        processBtn.addEventListener('click', async () => {
            const file = fileInput.files[0];
            if (!file) return;
            
            try {
                // Leer el archivo Excel
                const data = await file.arrayBuffer();
                const workbook = XLSX.read(data);
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // Convertir a JSON
                const jsonData = XLSX.utils.sheet_to_json(worksheet);
                
                // Asignar zonas
                processedData = jsonData.map(row => ({
                    ...row,
                    Zona: asignarZona(row.Calle)
                }));
                
                // Mostrar estadísticas
                const totalCalles = processedData.length;
                const callesEncontradas = processedData.filter(row => row.Zona !== "").length;
                
                resultsDiv.innerHTML = `
                    <h3>Resultados del procesamiento:</h3>
                    <p>Total de calles procesadas: ${totalCalles}</p>
                    <p>Calles con zona asignada: ${callesEncontradas}</p>
                    <p>Calles no identificadas: ${totalCalles - callesEncontradas}</p>
                `;
                
                // Habilitar botón de descarga
                downloadBtn.disabled = false;
                
            } catch (error) {
                resultsDiv.innerHTML = `<p style="color: red;">Error al procesar el archivo: ${error.message}</p>`;
            }
        });

        // Descargar el resultado como Excel
        downloadBtn.addEventListener('click', () => {
            if (processedData.length === 0) return;
            
            try {
                // Crear nueva hoja de cálculo
                const newWorksheet = XLSX.utils.json_to_sheet(processedData);
                
                // Crear nuevo libro de Excel
                const newWorkbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(newWorkbook, newWorksheet, "Calles con Zonas");
                
                // Descargar el archivo
                XLSX.writeFile(newWorkbook, "calles_con_zonas.xlsx");
                
                resultsDiv.innerHTML += `<p style="color: green;">Archivo descargado con éxito!</p>`;
            } catch (error) {
                resultsDiv.innerHTML += `<p style="color: red;">Error al generar el archivo: ${error.message}</p>`;
            }
        });
    </script>
</body>
</html>